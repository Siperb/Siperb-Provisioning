const Siperb={GetSession:e=>new Promise(async(o,n)=>{try{const i=await fetch("https://api.siperb.com/Login",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(!i.ok)return console.log("GetSession: %cFailed to retrieve session","color: red;"),n();try{const e=await i.json();return console.log("GetSession: %cSession retrieved successfully","color: green;"),"undefined"!=typeof window&&(window.SiperbAPI=window.SiperbAPI||{},window.SiperbAPI.SESSION_TOKEN=e.SessionToken,window.SiperbAPI.USER_ID=e.UserId),o(e)}catch(e){return console.log(`GetSession: %cError occurred while parsing response: ${e.message}`,"color: red;"),n()}}catch(e){return console.log(`GetSession: %cError occurred: ${e.message}`,"color: red;"),n()}}),GetDevices:e=>new Promise(async function(o,n){let i=!1;if("boolean"==typeof e.EnableCache&&!0===e.EnableCache)if("string"==typeof e.SessionKey&&""!=e.SessionKey){if(console.log(`GetSession: %cUsing SessionKey: ${e.SessionKey}`,"color: blue;"),"undefined"!=typeof window&&void 0!==window.localStorage){let n=localStorage.getItem(e.SessionKey);if(n)try{n=JSON.parse(n),"undefined"!=typeof window&&(window.SiperbAPI=window.SiperbAPI||{},window.SiperbAPI.SESSION=n),o(n),i=!0,console.log("GetSession: %cUsing cached session","color: green;")}catch(e){console.log(`GetSession: %cError parsing cached session: ${e.message}`,"color: red;")}}}else console.log("GetSession: %cEnableCache is enabled, but no CacheKey provided","color: orange;");const s=`https://api.siperb.com/Users/${e.UserId}/Devices/`,r={method:"GET",headers:{"Content-Type":"application/json","X-Api-Key":e.SessionToken}};try{let n=await fetch(s,r);if(n.ok){console.log("GetSession: %cGot session from API","color: green;");try{let s=await n.json();"boolean"==typeof e.EnableCache&&!0===e.EnableCache&&"string"==typeof e.SessionKey&&""!==e.SessionKey&&"undefined"!=typeof window&&void 0!==window.localStorage&&(window.localStorage.setItem(e.SessionKey,JSON.stringify(s)),console.log("GetSession: %cUpdated Session","color: green;")),"undefined"!=typeof window&&(window.SiperbAPI=window.SiperbAPI||{},window.SiperbAPI.DEVICES=s),i||o(s)}catch(e){console.log(`GetSession: %cError getting Session: ${e.message}`,"color: red;")}}else 403==n.status?(console.log("GetSession: %c403 Forbidden","color: red;"),i||o(null)):(console.log(`GetSession: %cBad Response ${n.status}`,"color: red;"),i||o(null))}catch(e){console.log(`GetSession: %cError getting session: ${e.message}`,"color: red;"),i||o(null)}}),GetProvisioning:e=>new Promise(async function(o,n){let i=!1;if("boolean"==typeof e.EnableCache&&!0===e.EnableCache)if("string"==typeof e.ProvisioningKey&&""!=e.ProvisioningKey){if(console.log(`GetProvisioning: %cUsing ProvisioningKey: ${e.ProvisioningKey}`,"color: blue;"),"undefined"!=typeof window&&void 0!==window.localStorage){let n=localStorage.getItem(e.ProvisioningKey);if(n)try{n=JSON.parse(n),"undefined"!=typeof window&&(window.SiperbAPI=window.SiperbAPI||{},window.SiperbAPI.PROVISIONING=n),o(n),i=!0,console.log("GetProvisioning: %cUsing cached Provisioning","color: green;")}catch(e){console.log(`GetProvisioning: %cError parsing cached Provisioning: ${e.message}`,"color: red;")}}}else console.log("GetProvisioning: %cEnableCache is enabled, but no ProvisioningKey provided","color: orange;");const s=`https://api.siperb.com/Users/${e.UserId}/Devices/${e.DeviceToken}/?password=yes&settings_json=yes`,r={method:"GET",headers:{"Content-Type":"application/json","X-Api-Key":e.SessionToken}};try{let n=await fetch(s,r);if(n.ok){console.log("GetProvisioning: %cGot Provisioning from API","color: green;");try{let s=await n.json();s=s.Settings_json||{},"boolean"==typeof e.EnableCache&&!0===e.EnableCache&&"string"==typeof e.ProvisioningKey&&""!==e.ProvisioningKey&&"undefined"!=typeof window&&void 0!==window.localStorage&&(window.localStorage.setItem(e.ProvisioningKey,JSON.stringify(s)),console.log("GetProvisioning: %cUpdated Provisioning","color: green;")),"undefined"!=typeof window&&(window.SiperbAPI=window.SiperbAPI||{},window.SiperbAPI.PROVISIONING=s),i||o(s)}catch(e){console.log(`GetProvisioning: %cError getting Provisioning: ${e.message}`,"color: red;")}}else 403==n.status?(console.log("GetProvisioning: %c403 Forbidden","color: red;"),i||o(null)):(console.log(`GetProvisioning: %cBad Response ${n.status}`,"color: red;"),i||o(null))}catch(e){console.log(`GetProvisioning: %cError getting Provisioning: ${e.message}`,"color: red;"),i||o(null)}})};export default Siperb;"undefined"!=typeof window&&(window.SiperbAPI=window.SiperbAPI||{},Object.assign(window.SiperbAPI,Siperb));